/*! cloudflarejs-rocketloader-0.9.0 Tue Jun 11 2013 12:24:14
 */
CloudFlare.define("cloudflare/rocket",["cloudflare/deferred","cloudflare/loader","cloudflare/console","cloudflare/path","cloudflare/dom","cloudflare/iterator","cloudflare/utility"],function(e,t,n,r,o,i,a){var s=function(e,t,n,r,o){return function(){function i(){return"function"==typeof e&&"object"==typeof t&&"object"==typeof n&&"string"==typeof o&&"string"==typeof r}function a(e,t){this._options=t?t:{},void 0==this._options.includeLocation&&(this._options.includeLocation=!1),this.validateHandler(e),this._handler=e,this.reset()}function s(e){s.super_.call(this,e,{ignoreWhitespace:!0,verbose:!1,enforceEmptyTags:!1})}function c(e,t){this.reset(),this._options=t?t:{},void 0==this._options.ignoreWhitespace&&(this._options.ignoreWhitespace=!1),void 0==this._options.verbose&&(this._options.verbose=!0),void 0==this._options.enforceEmptyTags&&(this._options.enforceEmptyTags=!0),"function"==typeof e&&(this._callback=e)}function l(e,t){var n=function(){};n.prototype=t.prototype,e.super_=t,e.prototype=new n,e.prototype.constructor=e}if(!i()){if(this.Tautologistics){if(this.Tautologistics.NodeHtmlParser)return}else this.Tautologistics={};this.Tautologistics.NodeHtmlParser={},t=this.Tautologistics.NodeHtmlParser}var d={Text:"text",Directive:"directive",Comment:"comment",Script:"script",Style:"style",Tag:"tag"};a._reTrim=/(^\s+|\s+$)/g,a._reTrimComment=/(^\!--|--$)/g,a._reWhitespace=/\s/g,a._reTagName=/^\s*(\/?)\s*([^\s\/]+)/,a._reAttrib=/([^=<>\"\'\s]+)\s*=\s*"([^"]*)"|([^=<>\"\'\s]+)\s*=\s*'([^']*)'|([^=<>\"\'\s]+)\s*=\s*([^'"\s]+)|([^=<>\"\'\s\/]+)/g,a._reTags=/[\<\>]/g,a.prototype.parseComplete=function(e){this.reset(),this.parseChunk(e),this.done()},a.prototype.parseChunk=function(e){this._done&&this.handleError(Error("Attempted to parse chunk after parsing already done")),this._buffer+=e,this.parseTags()},a.prototype.done=function(){if(!this._done){if(this._done=!0,this._buffer.length){var e=this._buffer;this._buffer="";var t={raw:e,data:this._parseState==d.Text?e:e.replace(a._reTrim,""),type:this._parseState};(this._parseState==d.Tag||this._parseState==d.Script||this._parseState==d.Style)&&(t.name=this.parseTagName(t.data)),this.parseAttribs(t),this._elements.push(t)}this.writeHandler(),this._handler.done()}},a.prototype.peek=function(){this._handler.peek()},a.prototype.reset=function(){this._buffer="",this._done=!1,this._elements=[],this._elementsCurrent=0,this._current=0,this._next=0,this._location={row:0,col:0,charOffset:0,inBuffer:0},this._parseState=d.Text,this._prevTagSep="",this._tagStack=[],this._handler.reset()},a.prototype._options=null,a.prototype._handler=null,a.prototype._buffer=null,a.prototype._done=!1,a.prototype._elements=null,a.prototype._elementsCurrent=0,a.prototype._current=0,a.prototype._next=0,a.prototype._location=null,a.prototype._parseState=d.Text,a.prototype._prevTagSep="",a.prototype._tagStack=null,a.prototype.parseTagAttribs=function(e){for(var t=e.length,n=0;t>n;){var r=e[n++];(r.type==d.Tag||r.type==d.Script||r.type==d.style)&&this.parseAttribs(r)}return e},a.prototype.parseAttribs=function(e){if(e.type==d.Script||e.type==d.Style||e.type==d.Tag){var t=e.data.split(a._reWhitespace,1)[0],n=e.data.substring(t.length);if(!(1>n.length)){var r;for(a._reAttrib.lastIndex=0;r=a._reAttrib.exec(n);)void 0==e.attribs&&(e.attribs={}),"string"==typeof r[1]&&r[1].length?e.attribs[r[1]]=r[2]:"string"==typeof r[3]&&r[3].length?e.attribs[""+r[3]]=""+r[4]:"string"==typeof r[5]&&r[5].length?e.attribs[r[5]]=r[6]:"string"==typeof r[7]&&r[7].length&&(e.attribs[r[7]]=r[7])}}},a.prototype.parseTagName=function(e){if(null==e||""==e)return"";var t=a._reTagName.exec(e);return t?(t[1]?"/":"")+t[2]:""},a.prototype.parseTags=function(){for(var e=this._buffer.length-1;a._reTags.test(this._buffer);){this._next=a._reTags.lastIndex-1;var t=this._buffer.charAt(this._next),n=this._buffer.substring(this._current,this._next),r={raw:n,data:this._parseState==d.Text?n:n.replace(a._reTrim,""),type:this._parseState},o=this.parseTagName(r.data);if(this._tagStack.length)if(this._tagStack[this._tagStack.length-1]==d.Script){if("/script"==o)this._tagStack.pop();else if(0!=r.raw.indexOf("!--")&&(r.type=d.Text,this._elements.length&&this._elements[this._elements.length-1].type==d.Text)){var i=this._elements[this._elements.length-1];i.raw=i.data=i.raw+this._prevTagSep+r.raw,r.raw=r.data=""}}else if(this._tagStack[this._tagStack.length-1]==d.Style){if("/style"==o)this._tagStack.pop();else if(0!=r.raw.indexOf("!--"))if(r.type=d.Text,this._elements.length&&this._elements[this._elements.length-1].type==d.Text){var i=this._elements[this._elements.length-1];""!=r.raw?(i.raw=i.data=i.raw+this._prevTagSep+r.raw,r.raw=r.data=""):i.raw=i.data=i.raw+this._prevTagSep}else""!=r.raw&&(r.raw=r.data=r.raw)}else if(this._tagStack[this._tagStack.length-1]==d.Comment){var s=r.raw.length;if("-"==r.raw.charAt(s-2)&&"-"==r.raw.charAt(s-1)&&">"==t)if(this._tagStack.pop(),this._elements.length&&this._elements[this._elements.length-1].type==d.Comment){var i=this._elements[this._elements.length-1];i.raw=i.data=(i.raw+r.raw).replace(a._reTrimComment,""),r.raw=r.data="",r.type=d.Text}else r.type=d.Comment;else if(r.type=d.Comment,this._elements.length&&this._elements[this._elements.length-1].type==d.Comment){var i=this._elements[this._elements.length-1];i.raw=i.data=i.raw+r.raw+t,r.raw=r.data="",r.type=d.Text}else r.raw=r.data=r.raw+t}if(r.type==d.Tag){if(r.name=o,0==r.raw.indexOf("!--")){r.type=d.Comment,delete r.name;var s=r.raw.length;"-"==r.raw.charAt(s-1)&&"-"==r.raw.charAt(s-2)&&">"==t?r.raw=r.data=r.raw.replace(a._reTrimComment,""):(r.raw+=t,this._tagStack.push(d.Comment))}else 0==r.raw.indexOf("!")||0==r.raw.indexOf("?")?r.type=d.Directive:"script"==r.name?(r.type=d.Script,"/"!=r.data.charAt(r.data.length-1)&&this._tagStack.push(d.Script)):"/script"==r.name?r.type=d.Script:"style"==r.name?(r.type=d.Style,"/"!=r.data.charAt(r.data.length-1)&&this._tagStack.push(d.Style)):"/style"==r.name&&(r.type=d.Style);r.name&&"/"==r.name.charAt(0)&&(r.data=r.name)}(""!=r.raw||r.type!=d.Text)&&(this._options.includeLocation&&!r.location&&(r.location=this.getLocation(r.type==d.Tag)),this.parseAttribs(r),this._elements.push(r),r.type!=d.Text&&r.type!=d.Comment&&r.type!=d.Directive&&"/"==r.data.charAt(r.data.length-1)&&this._elements.push({raw:"/"+r.name,data:"/"+r.name,name:"/"+r.name,type:r.type})),this._parseState="<"==t?d.Tag:d.Text,this._current=this._next+1,this._prevTagSep=t}this._options.includeLocation&&(this.getLocation(),this._location.row+=this._location.inBuffer,this._location.inBuffer=0,this._location.charOffset=0),this._buffer=e>=this._current?this._buffer.substring(this._current):"",this._current=0,this.writeHandler()},a.prototype.getLocation=function(e){for(var t,n=this._location,r=this._current-(e?1:0),o=e&&0==n.charOffset&&0==this._current;r>n.charOffset;n.charOffset++)t=this._buffer.charAt(n.charOffset),"\n"==t?(n.inBuffer++,n.col=0):"\r"!=t&&n.col++;return{line:n.row+n.inBuffer+1,col:n.col+(o?0:1)}},a.prototype.validateHandler=function(e){if("object"!=typeof e)throw Error("Handler is not an object");if("function"!=typeof e.reset)throw Error("Handler method 'reset' is invalid");if("function"!=typeof e.done)throw Error("Handler method 'done' is invalid");if("function"!=typeof e.writeTag)throw Error("Handler method 'writeTag' is invalid");if("function"!=typeof e.writeText)throw Error("Handler method 'writeText' is invalid");if("function"!=typeof e.writeComment)throw Error("Handler method 'writeComment' is invalid");if("function"!=typeof e.writeDirective)throw Error("Handler method 'writeDirective' is invalid")},a.prototype.writeHandler=function(e){if(e=!!e,!this._tagStack.length||e)for(;this._elements.length;){var t=this._elements.shift();switch(t.type){case d.Comment:this._handler.writeComment(t);break;case d.Directive:this._handler.writeDirective(t);break;case d.Text:this._handler.writeText(t);break;default:this._handler.writeTag(t)}}},a.prototype.handleError=function(e){if("function"!=typeof this._handler.error)throw e;this._handler.error(e)},l(s,c),s.prototype.done=function(){var e,t={},n=p.getElementsByTagName(function(e){return"rss"==e||"feed"==e},this.dom,!1);if(n.length&&(e=n[0]),e){if("rss"==e.name){t.type="rss",e=e.children[0],t.id="";try{t.title=p.getElementsByTagName("title",e.children,!1)[0].children[0].data}catch(r){}try{t.link=p.getElementsByTagName("link",e.children,!1)[0].children[0].data}catch(r){}try{t.description=p.getElementsByTagName("description",e.children,!1)[0].children[0].data}catch(r){}try{t.updated=new Date(p.getElementsByTagName("lastBuildDate",e.children,!1)[0].children[0].data)}catch(r){}try{t.author=p.getElementsByTagName("managingEditor",e.children,!1)[0].children[0].data}catch(r){}t.items=[],p.getElementsByTagName("item",e.children).forEach(function(e){var n={};try{n.id=p.getElementsByTagName("guid",e.children,!1)[0].children[0].data}catch(r){}try{n.title=p.getElementsByTagName("title",e.children,!1)[0].children[0].data}catch(r){}try{n.link=p.getElementsByTagName("link",e.children,!1)[0].children[0].data}catch(r){}try{n.description=p.getElementsByTagName("description",e.children,!1)[0].children[0].data}catch(r){}try{n.pubDate=new Date(p.getElementsByTagName("pubDate",e.children,!1)[0].children[0].data)}catch(r){}t.items.push(n)})}else{t.type="atom";try{t.id=p.getElementsByTagName("id",e.children,!1)[0].children[0].data}catch(r){}try{t.title=p.getElementsByTagName("title",e.children,!1)[0].children[0].data}catch(r){}try{t.link=p.getElementsByTagName("link",e.children,!1)[0].attribs.href}catch(r){}try{t.description=p.getElementsByTagName("subtitle",e.children,!1)[0].children[0].data}catch(r){}try{t.updated=new Date(p.getElementsByTagName("updated",e.children,!1)[0].children[0].data)}catch(r){}try{t.author=p.getElementsByTagName("email",e.children,!0)[0].children[0].data}catch(r){}t.items=[],p.getElementsByTagName("entry",e.children).forEach(function(e){var n={};try{n.id=p.getElementsByTagName("id",e.children,!1)[0].children[0].data}catch(r){}try{n.title=p.getElementsByTagName("title",e.children,!1)[0].children[0].data}catch(r){}try{n.link=p.getElementsByTagName("link",e.children,!1)[0].attribs.href}catch(r){}try{n.description=p.getElementsByTagName("summary",e.children,!1)[0].children[0].data}catch(r){}try{n.pubDate=new Date(p.getElementsByTagName("updated",e.children,!1)[0].children[0].data)}catch(r){}t.items.push(n)})}this.dom=t}s.super_.prototype.done.call(this)},c._emptyTags={area:1,base:1,basefont:1,br:1,col:1,frame:1,hr:1,img:1,input:1,isindex:1,link:1,meta:1,param:1,embed:1},c.reWhitespace=/^\s*$/,c.prototype.dom=null,c.prototype.reset=function(){this.dom=[],this._done=!1,this._tagStack=[],this._tagStack.last=function(){return this.length?this[this.length-1]:null}},c.prototype.done=function(){this._done=!0,this.handleCallback(null)},c.prototype.peek=function(){this.handleCallback(null)},c.prototype.writeTag=function(e){this.handleElement(e)},c.prototype.writeText=function(e){this._options.ignoreWhitespace&&c.reWhitespace.test(e.data)||this.handleElement(e)},c.prototype.writeComment=function(e){this.handleElement(e)},c.prototype.writeDirective=function(e){this.handleElement(e)},c.prototype.error=function(e){this.handleCallback(e)},c.prototype._options=null,c.prototype._callback=null,c.prototype._done=!1,c.prototype._tagStack=null,c.prototype.handleCallback=function(e){if("function"==typeof this._callback)this._callback(e,this.dom);else if(e)throw e},c.prototype.isEmptyTag=function(e){var t=e.name.toLowerCase();return"/"==t.charAt(0)&&(t=t.substring(1)),this._options.enforceEmptyTags&&!!c._emptyTags[t]},c.prototype.handleElement=function(e){if(this._done&&this.handleCallback(Error("Writing to the handler after done() called is not allowed without a reset()")),this._options.verbose||(delete e.raw,("tag"==e.type||"script"==e.type||"style"==e.type)&&delete e.data),this._tagStack.last())if(e.type!=d.Text&&e.type!=d.Comment&&e.type!=d.Directive)if("/"==e.name.charAt(0)){var t=e.name.substring(1);if(!this.isEmptyTag(e)){for(var n=this._tagStack.length-1;n>-1&&this._tagStack[n--].name!=t;);if(n>-1||this._tagStack[0].name==t)for(;this._tagStack.length-1>n;)this._tagStack.pop()}}else this._tagStack.last().children||(this._tagStack.last().children=[]),this._tagStack.last().children.push(e),this.isEmptyTag(e)||this._tagStack.push(e);else this._tagStack.last().children||(this._tagStack.last().children=[]),this._tagStack.last().children.push(e);else e.type!=d.Text&&e.type!=d.Comment&&e.type!=d.Directive?"/"!=e.name.charAt(0)&&(this.dom.push(e),this.isEmptyTag(e)||this._tagStack.push(e)):this.dom.push(e)};var p={testElement:function(e,t){if(!t)return!1;for(var n in e)if("tag_name"==n){if("tag"!=t.type&&"script"!=t.type&&"style"!=t.type)return!1;if(!e.tag_name(t.name))return!1}else if("tag_type"==n){if(!e.tag_type(t.type))return!1}else if("tag_contains"==n){if("text"!=t.type&&"comment"!=t.type&&"directive"!=t.type)return!1;if(!e.tag_contains(t.data))return!1}else if(!t.attribs||!e[n](t.attribs[n]))return!1;return!0},getElements:function(e,t,n,r){function o(e){return function(t){return t==e}}if(n=void 0===n||null===n||!!n,r=isNaN(parseInt(r))?-1:parseInt(r),!t)return[];var i,a=[];for(var s in e)"function"!=typeof e[s]&&(e[s]=o(e[s]));if(p.testElement(e,t)&&a.push(t),r>=0&&a.length>=r)return a;if(n&&t.children)i=t.children;else{if(!(t instanceof Array))return a;i=t}for(var c=0;i.length>c&&(a=a.concat(p.getElements(e,i[c],n,r)),!(r>=0&&a.length>=r));c++);return a},getElementById:function(e,t,n){var r=p.getElements({id:e},t,n,1);return r.length?r[0]:null},getElementsByTagName:function(e,t,n,r){return p.getElements({tag_name:e},t,n,r)},getElementsByTagType:function(e,t,n,r){return p.getElements({tag_type:e},t,n,r)}};t.Parser=a,t.DefaultHandler=c,t.RssHandler=s,t.ElementType=d,t.DomUtils=p}(),t}(function(){},{},{},"","");s.decodeEntities=function(e){var t=document.createElement("span");return t.innerHTML=e,o.hasTextContent()?t.textContent:t.innerText},s.abstractNodeToElement=function(e,t){var r;switch(e.type){case"script-text":return n.error("Encountered script-text node! WHAT DO!"),document.createTextNode(e.data);case"text":return t&&"SCRIPT"==t.nodeName?document.createTextNode(e.data):document.createTextNode(s.decodeEntities(e.data));case"comment":try{return document.createComment(e.data)}catch(a){return document.createComment("Malformed comment. "+a.message)}case"directive":return document.createComment("Ignored directive from document.write stream.");case"tag":case"script":e.attribs||(e.attribs={});for(var c in e.attribs)e.attribs[c.toLowerCase()]=s.decodeEntities(e.attribs[c]),c.toLowerCase()!=c&&delete e.attribs[c];("script"==e.type.toLowerCase()||"script"==e.name.toLowerCase())&&("src"in e.attribs&&(e.attribs["data-rocketsrc"]=e.attribs.src,delete e.attribs.src),e.attribs.type="text/rocketscript");default:r=document.createElement(e.name)}return i.forEach(e.attribs,function(e,t){/^id$|^src$/.test(t)?r[t.toLowerCase()]=e:/^class$/.test(t)?r.className=e:o.setAttribute(r,t,e)}),r},s.isValidParent=function(e,t){var n=s.elementSemantics,r=n[e.toLowerCase()],o=n[t.toLowerCase()];return o&&o.exclusive&&e in o.exclusive?!1:!o||"body"===t||o.inclusive&&e in o.inclusive||!r||!r.contentCategories||!o.contentModel||"empty"!==o.contentModel&&("transparent"===o.contentModel||o.contentModel in r.contentCategories)?!0:!1},s.elementSemantics={head:{contentCategories:{},contentModel:"metadata"},title:{contentCategories:{metadata:1},contentModel:"text"},base:{contentCategories:{metadata:1},contentModel:"empty"},link:{contentCategories:{metadata:1},contentModel:"empty"},meta:{contentCategories:{metadata:1},contentModel:"empty"},style:{contentCategories:{metadata:1,flow:1},contentModel:"text"},script:{contentCategories:{metadata:1,flow:1,phrasing:1},contentModel:"text"},noscript:{contentCategories:{metadata:1,flow:1,phrasing:1},contentModel:"transparent",exclusive:{noscript:"recursive"}},body:{contentCategories:{sectioning:1},contentModel:"flow"},section:{contentCategories:{flow:1,sectioning:1},contentModel:"flow"},nav:{contentCategories:{flow:1,sectioning:1},contentModel:"flow"},article:{contentCategories:{flow:1,sectioning:1},contentModel:"flow"},aside:{contentCategories:{flow:1,sectioning:1},contentModel:"flow"},h1:{contentCategories:{flow:1,heading:1},contentModel:"phrasing"},h2:{contentCategories:{flow:1,heading:1},contentModel:"phrasing"},h3:{contentCategories:{flow:1,heading:1},contentModel:"phrasing"},h4:{contentCategories:{flow:1,heading:1},contentModel:"phrasing"},h5:{contentCategories:{flow:1,heading:1},contentModel:"phrasing"},h6:{contentCategories:{flow:1,heading:1},contentModel:"phrasing"},hgroup:{contentCategories:{flow:1,heading:1},contentModel:"empty",inclusive:{h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}},header:{contentCategories:{flow:1},contentModel:"flow",exclusive:{header:"recursive",footer:"recursive"}},footer:{contentCategories:{flow:1},contentModel:"flow",exclusive:{header:"recursive",footer:"recursive"}},address:{contentCategories:{flow:1},contentModel:"flow",exclusive:{address:"recursive",header:"recursive",footer:"recursive"}},p:{contentCategories:{flow:1},contentModel:"phrasing"},hr:{contentCategories:{flow:1},contentModel:"empty"},pre:{contentCategories:{flow:1},contentModel:"phrasing"},blockquote:{contentCategories:{flow:1,sectioning:1},contentModel:"flow"},ol:{contentCategories:{flow:1},contentModel:"empty",inclusive:{li:1}},ul:{contentCategories:{flow:1},contentModel:"flow",inclusive:{li:1}},li:{contentCategories:{},contentModel:"flow"},dl:{contentCategories:{flow:1},contentModel:"empty",inclusive:{dt:1,dd:1}},dt:{contentCategories:{},contentModel:"phrasing"},dd:{contentCategories:{},contentModel:"flow"},figure:{contentCategories:{flow:1,sectioning:1},contentModel:"flow",inclusive:{figcaption:1}},figcaption:{contentCategories:{},contentModel:"flow"},div:{contentCategories:{flow:1},contentModel:"flow"},a:{contentCategories:{flow:1,phrasing:1,interactive:1},contentModel:"transparent",exclusive:{}},em:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},strong:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},small:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},s:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},cite:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},q:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},dfn:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing",exclusive:{dfn:"recursive"}},abbr:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},time:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},code:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},"var":{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},abbr:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},samp:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},kbd:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},sub:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},sup:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},i:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},b:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},mark:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},ruby:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing",inclusive:{rt:1,rp:1}},rt:{contentCategories:{},contentModel:"phrasing"},rp:{contentCategories:{},contentModel:"phrasing"},bdi:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},bdo:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},span:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},br:{contentCategories:{flow:1,phrasing:1},contentModel:"empty"},wbr:{contentCategories:{flow:1,phrasing:1},contentModel:"empty"},ins:{contentCategories:{flow:1,phrasing:1},contentModel:"transparent"},del:{contentCategories:{flow:1,phrasing:1},contentModel:"transparent"},img:{contentCategories:{flow:1,phrasing:1,embedded:1},contentModel:"empty"},iframe:{contentCategories:{flow:1,phrasing:1,embedded:1,interactive:1},contentModel:"transparent"},embed:{contentCategories:{flow:1,phrasing:1,embedded:1,interactive:1},contentModel:"empty"},object:{contentCategories:{flow:1,phrasing:1,embedded:1,interactive:1},contentModel:"transparent",inclusive:{param:1}},param:{contentCategories:{},contentModel:"empty"},video:{contentCategories:{flow:1,phrasing:1,embedded:1},contentModel:"transparent"},audio:{contentCategories:{flow:1,phrasing:1,embedded:1,interactive:1},contentModel:"transparent"},source:{contentCategories:{},contentModel:"empty"},track:{contentCategories:{},contentModel:"empty"},canvas:{contentCategories:{flow:1,phrasing:1,embedded:1},contentModel:"transparent"},map:{contentCategories:{flow:1,phrasing:1},contentModel:"transparent"},area:{contentCategories:{flow:1,phrasing:1},contentModel:"empty"},table:{contentCategories:{flow:1},contentModel:"empty",inclusive:{caption:1,colgroup:1,thead:1,tfoot:1,tbody:1,tr:1}},caption:{contentCategories:{},contentModel:"flow",exclusive:{table:"recursive"}},colgroup:{contentCategories:{},contentModel:"empty",inclusive:{col:1}},col:{contentCategories:{},contentModel:"empty"},tbody:{contentCategories:{},contentModel:"empty",inclusive:{tr:1}},thead:{contentCategories:{},contentModel:"empty",inclusive:{tr:1}},tfoot:{contentCategories:{},contentModel:"empty",inclusive:{tr:1}},tr:{contentCategories:{},contentModel:"empty",inclusive:{td:1,th:1}},td:{contentCategories:{sectioning:1},contentModel:"flow"},th:{contentCategories:{},contentModel:"phrasing"},form:{contentCategories:{flow:1},contentModel:"flow",exclusive:{form:"recursive"}},fieldset:{contentCategories:{flow:1,sectioning:1},contentModel:"flow",inclusive:{legend:1}},legend:{contentCategories:{},contentModel:"phrasing"},label:{contentCategories:{flow:1,phrasing:1,interactive:1},contentModel:"phrasing"},input:{contentCategories:{flow:1,phrasing:1,interactive:1},contentModel:"empty"},button:{contentCategories:{flow:1,phrasing:1,interactive:1},contentModel:"phrasing"},select:{contentCategories:{flow:1,phrasing:1,interactive:1},contentModel:"empty",inclusive:{option:1,optgroup:1}},datalist:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing",inclusive:{option:1}},optgroup:{contentCategories:{},contentModel:"empty",inclusive:{option:1}},option:{contentCategories:{},contentModel:"text"},textarea:{contentCategories:{flow:1,phrasing:1,interactive:1},contentModel:"text"},keygen:{contentCategories:{flow:1,phrasing:1,interactive:1},contentModel:"empty"},output:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing"},progress:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing",exclusive:{progress:"recursive"}},meter:{contentCategories:{flow:1,phrasing:1},contentModel:"phrasing",exclusive:{meter:"recursive"}},details:{contentCategories:{flow:1,sectioning:1,interactive:1},contentModel:"flow",inclusive:{summary:1}},summary:{contentCategories:{},contentModel:"phrasing"},command:{contentCategories:{metadata:1,flow:1,phrasing:1},contentModel:"empty"},menu:{contentCategories:{flow:1,interactive:1},contentModel:"flow",inclusive:{li:1}}};var c=function(e){var t=e,r={},s={},c={},d={},p={},h=!1,u=function(e,i){var a=arguments,s=/^on/.test(e),c=s?e.substring(2):e,l=r[c];if(l)n.log(c+" handler added by "+(""+v.getExecutingScript())),l.push(a);else if(o.hasStandardEvents())d.addEventListener.apply(t,a);else try{d.attachEvent.apply(t,a)}catch(p){d.attachEvent(e,i)}},g=function(e,n){var a=arguments,s=/^on/.test(e)?e.substring(2):e,c=!1,l=r[s];if(l)i.forEach(l,function(e,t){return e.length!==a.length?!1:(i.forEach(e,function(n,r){return n!==a[r]?!1:(r===e.length-1&&(l.splice(t,1),c=!0),void 0)}),!c)});else if(o.hasStandardEvents())d.removeEventListener.apply(t,a);else try{d.detachEvent.apply(t,a)}catch(p){d.detachEvent(e,n)}},f=function(e,n){for(var r=e.split("."),o=r[r.length-1],i=t,a=0;r.length-1>a&&r[a]in i;a++)i=i[r[a]];o in i&&(d[e]=i[o],i[o]=function(t,r,o,a,s){if(v.getActivated())return n.apply(i,arguments);try{return d[e].apply(i,arguments)}catch(c){return d[e](t,r,o,a,s)}})},m=function(){i.forEach(d,function(e,n){for(var r=n.split("."),o=r[r.length-1],i=t,a=0;r.length-1>a&&r[a]in i;a++)i=i[r[a]];i[o]=e}),h=!0},y=function(e,n,r){var i=a.getOwnPropertyDescriptor(t,e)||{};(n||r)&&(p[e]={get:i.get,set:i.set,writable:i.writable,value:i.value},n&&(i.get=n),r&&(i.set=r),i.value=null,o.internetExplorer&&(delete i.writable,delete i.enumerable,delete i.value),a.defineProperty(t,e,i))},w=function(){i.forEach(p,function(e,n){var r=a.getOwnPropertyDescriptor(t,n);r.get=e.get,r.set=e.set,a.defineProperty(t,n,r)})},C=function(e){var n=9>o.internetExplorer?document.createEventObject():document.createEvent("HTMLEvents");return 9>o.internetExplorer?(n=document.createEventObject(),a.defineProperty(n,"type",{get:function(){return e}})):n.initEvent(e,!0,!1),o.safari&&(n=l.proxy(n)),a.defineProperty(n,"target",{get:function(){return t}}),n},_=function(e){var n="on"+e.toLowerCase(),i=d.addEventListener||d.attachEvent,a=function(t){t.captureHandler=arguments.callee,c[e]=t};if(y(n,function(){return s[n]},function(e){s[n]=e}),i)if(r[e]||(r[e]=[]),o.hasStandardEvents())i.call(t,e,a,!0);else try{i.call(t,n,a)}catch(l){i(n,a)}},E=function(e,s){var l="on"+e.toLowerCase(),p=d.removeEventListener||d.detachEvent,h=s||c[e];if("DOMContentLoaded"===e&&r[e].length&&!h&&(h=C(e),h.captureHandler=function(){}),9>o.internetExplorer&&t===window&&"load"===e&&r[e].length&&(h=C(e),h.captureHandler=function(){}),h){var u=h.stopPropagation;if(h.stopImmediatePropagation,r[e],u&&(h.stopPropagation=function(){h.propagationStopped=!0,u.apply(h,arguments)}),i.forEach(a.toArray(r[e]),function(e){var r=d.attachEvent?window:t,o=e[1];try{o.call(r,h)}catch(i){n.error(i.message)}return h.propagationStopped?!1:void 0}),!h.propagationStopped&&t[l])try{t[l].call(t,h)}catch(g){error(g)}if(o.hasStandardEvents())p.call(t,e,h.captureHandler,!0);else try{p.call(t,l,h.captureHandler)}catch(g){p(l,h.captureHandler)}}};return f("addEventListener",u),f("attachEvent",u),f("removeEventListener",g),f("detachEvent",g),{wrapNativeMethod:f,restoreNativeMethods:m,restoreNativeProperties:w,restore:function(){h=!0},isRestored:function(){return h},wrapNativeProperty:y,createEvent:C,deferEvent:_,fireEvent:E,getTarget:function(){return t},getNativeMethod:function(e){return d[e]}}},l=function(){var e=function(e){return function(t){return{set:function(n){t[e]=g(n)},get:function(){return u(t[e])}}}},t=function(e){return function(t){return function(){return i.map(t[e].apply(t,arguments),u)}}},n=function(e){return function(t){return function(n,r){var o=t[e](g(n),g(r));return o&&u(o)}}},s={insertBefore:n("insertBefore"),appendChild:n("appendChild"),replaceChild:n("replaceChild"),removeChild:n("removeChild"),getElementsByTagName:t("getElementsByTagName"),getElementsByClassName:t("getElementsByClassName"),firstChild:e("firstChild"),lastChild:e("lastChild"),nextSibling:e("nextSibling"),previousSibling:e("previousSibling"),parentNode:e("parentNode"),childNodes:function(e){return{set:function(t){e.childNodes=t},get:function(){return i.map(e.childNodes,u)}}}},c=i.extend({},s,{type:function(e){return{get:function(){var t=o.getAttribute(e,"type");return"text/rocketscript"===t?"text/javascript":t},set:function(t){o.setAttribute(e,"type",t)}}},src:function(e){return{get:function(){var t=o.getData(e,"rocketsrc");return t?r.resolveFullURL(t):e.src},set:function(t){o.setAttribute(e,"type","text/javascript"),e.src=t}}},hasAttribute:function(e){return function(t){return"src"===t?!!o.getData(e,"rocketsrc"):e.hasAttribute(t)}},getAttribute:function(e){return function(t){return"src"===t?o.getData(e,"rocketsrc"):e.getAttribute(t)}}}),l=function(e){return function(t){var n={isProxyNode:!0,proxiedNode:t},r=function(r,o){var i=e[o]?e[o](t):!1;"function"==typeof r?n[o]=i||function(){return t[o].apply(t,arguments)}:a.defineProperty(n,o,{get:i.get||function(){return t[o]},set:i.set||function(e){t[o]=e}})};return i.forEach(t,r,null,!0),n}},d=l(s),p=l(c),h=l({}),u=function(e){return e?"nodeName"in e?8==o.internetExplorer||!e||e.isProxyNode?e:"SCRIPT"===e.nodeName?p(e):d(e):h(e):void 0},g=function(e){return e&&e.isProxyNode?e.proxiedNode:e};return o.safari&&"Node"in window&&function(){i.forEach(["appendChild","insertBefore","replaceChild","removeChild"],function(e){var t=Element.prototype[e];Node.prototype[e]=function(e,n){return e=g(e),n=g(n),t.call(this,e,n)}})}(),{proxy:u,unproxy:g}}(),d=function(){var e=document,t=!0,r=!0,a="loading",d=null,p=new s.Parser(new s.DefaultHandler(function(e,t){e?n.error("The parser experienced an error. "+e.message):v.getExecutingScript().after(t)})),h=function(){d=document.getElementsByTagName("body")[0],a="complete",t=!1,y.fireEvent("DOMContentLoaded"),y.fireEvent("readystatechange")},u=function(e){"string"!=typeof e&&(e=""+e),n.log("Appending to document.write buffer: \n"+e),p.parseChunk(e),p.peek()},g=function(){var e=p._buffer;p.reset(),e.length&&p.parseChunk(e)},f=function(t,o){var a=y.getNativeMethod("getElementsByTagName").call(e,t);return n.log("Looking up elements of type "+t+(o?", but overriding script introspection support":"")),!o&&/^script$/i.test(t)&&r?i.map(a,l.proxy):a},y=c(e),w=c(e.documentElement);return i.extend(y,{ready:h,write:u,flush:g,getParser:function(){return p}}),y.wrapNativeMethod("write",function(e){e&&u(e)}),y.wrapNativeMethod("writeln",function(e){e&&u(e+"\n")}),y.wrapNativeMethod("open",function(){n.log("Ignoring document.open..")}),y.wrapNativeMethod("close",function(){n.log("Ignoring document.close..")}),y.wrapNativeMethod("createElement",function(e){var t=o.createElement(e);return"script"===e&&(t=m(t).getTarget()),t}),y.wrapNativeMethod("getElementsByTagName",f),w.wrapNativeMethod("getElementsByTagName",f),y.wrapNativeMethod("getElementById",function(t){var n=y.getNativeMethod("getElementById").call(e,t);return n&&n.nodeName&&"script"==n.nodeName.toLowerCase()?l.proxy(n):n}),y.wrapNativeMethod("getElementsByClassName",function(t){var n=y.getNativeMethod("getElementsByClassName").call(e,t),r=[];return i.forEach(n,function(e,t){e&&e.nodeName&&"script"==e.nodeName.toLowerCase()&&(e=l.proxy(e)),r[t]=e}),r}),y.wrapNativeMethod("documentElement.doScroll",function(){if(t)throw"The data necessary to complete this operation is not yet available.";y.getNativeMethod("documentElement.doScroll").apply(this,arguments)}),y.wrapNativeProperty("readyState",function(){return a}),y.deferEvent("DOMContentLoaded"),y.deferEvent("readystatechange"),y},p=function(){var e=window,t=function(t){"complete"===document.readyState?t():n.getNativeMethod("addEventListener")?n.getNativeMethod("addEventListener").call(e,"load",t,!0):n.getNativeMethod("attachEvent")("onload",t)},n=c(e);return i.extend(n,{whenLoaded:t,load:function(){n.fireEvent("load")}}),n.wrapNativeMethod("getComputedStyle",function(e,t){return e.isProxyNode&&(e=e.proxiedNode),n.getNativeMethod("getComputedStyle").call(this,e,t)}),n.deferEvent("load"),n},h=function(){var n={},o={},i=0,s=/^https?:\/\/.*?\.?(livefyre\.com\/|api\.stripe\.com|api\.solvemedia\.com\/papi\/_challenge\.js)/;return function(c){return s.test(c)?e.reject(Error("Blacklisted URL; Bailing from bag")):c.length>2048?e.reject(Error("Provided URL exceeds maximum allowed length of 2048 bytes.")):(c=r.resolveFullURL(c),n[c]=n[c]||function(e,t){t=parseInt(t)||500,o[c]&&(t>499&&803>t||!e?o[c].reject(Error("Script proxy demands script resolution failover.")):o[c].resolve(e)),delete o[c]},i++||a.nextTick(function(){i=0,t.load(n,function(){}),n={}}),(o[c]=o[c]||e.defer()).promise)}}(),u=function(){var t=function(){var e=function(){for(var e=0,n=[];t.length>e;){var i=t[e],a=o.getData(i,"rocketoptimized"),s=o.getAttribute(i,"type");a||"text/rocketscript"!==s?e++:n[n.push(f(i))-1].bookmark()}return r=n.length?0:r+1,n},t=document.getElementsByTagName("script",!0),r=0,i=function(){n.error("Scanner called empty script handler!")
},a=void 0,s={scan:function(){n.log("Scanning for scripts.");var t=e();t.length&&i(t)},start:function(){a||function(){s.scan(),50>r?a=setTimeout(arguments.callee,25):s.stop()}()},stop:function(){a&&clearInterval(a),s.scan(),a=void 0},setScriptHandler:function(e){i=e}};return o.onLoad.then(function(){n.log("Document fully loaded.")}),s},r=t(),a=[],s=null,c=!1,l=e.ref(),d=function(e){a=a.concat(e)},p=function(){return n.log("Queueing "+a.length+" scripts for execution."),i.forEach(a,function(e){l=l.then(function(){return(s=e).execute()})}),a=[],l},h={execute:function(){return c=!0,r.scan(),p().then(function(){return a.length?h.execute():(_.length&&(i.forEach(_,function(e){e.call(window)}),_=[]),void 0)}).then(function(){var e=setInterval(function(){a.length&&(clearInterval(e),h.execute())},250)})},pushScript:function(e){a.push(e)},getActivated:function(){return c},setExecutingScript:function(e){e&&(s=e)},getExecutingScript:function(){return s}};return r.setScriptHandler(d),r.start(),h},g=function(t,r){var i,a,s=function(){"readyState"in p&&"loaded"!=p.readyState&&"complete"!=p.readyState||(n.log('Lost script from "'+r+'" is done recovering.'),d.resolve(),l())},c=function(){n.error('Lost script from "'+r+'" errored out during recovery.'),d.resolve(),l()},l=function(){o.removeEventListener(p,"load",s),o.removeEventListener(p,"readystatechange",s),o.removeEventListener(p,"error",c)},d=e.defer(),p=o.createElement("script");return t.parentNode||(i=document.getElementsByTagName("script",!0),a=i[i.length-1],a.parentNode.insertBefore(t,a.nextSibling)),t.parentNode.insertBefore(p,t.nextSibling),o.addEventListener(p,"load",s),o.addEventListener(p,"readystatechange",s),o.addEventListener(p,"error",c),n.log('Attempting to recover script from "'+r+'"'),p.type="text/javascript",p.src=r,setTimeout(function(){l(),d.resolve()},1e4),d.promise},f=function(t){var c=function(){t.parentNode&&t.parentNode.replaceChild(u,t)},l=function(){u.parentNode&&u.parentNode.replaceChild(t,u)},d=o.getData(t,"rocketsrc"),p=d?r.resolveFullURL(d):"",u=document.createTextNode(""),m=e.ref(),y=[],C=[],_=e.defer(),E=function(e){return/^\s*(<!--)\s*/.test(e)&&(n.log("Applying epic hack for inline comment removal!",n.HACK),e=e.replace(/^\s*<!--|-->\s*$/g,"/* ROCKET: Removed HTML Comment */")),e+="\n/*\n//@ sourceURL=/"+(p||"inline-"+a.uid()+".js")+"\n*/"},b={bookmark:c,restore:l,executeSubscripts:function(){return y.length&&i.forEach(y,function(t){m=e.when(m,function(){return v.setExecutingScript(t),t.execute()})}),y=[],m},execute:function(){return x.then(function(e){e=E(e),l(),n.log("Executing "+(""+b));try{a.globalEval(e)}catch(t){n.error("Rocket failed to execute a script. "+t.message)}return _.resolve(),w.flush(),b.executeSubscripts()},function(e){return n.error("Failed to resolve text content for "+(""+b)+". "+e.message),l(),g(t,p).then(function(){return _.resolve(),w.flush(),b.executeSubscripts()})})},getSource:function(){return p},isExternal:function(){return!!p},isAttached:function(){return!!t.parentNode},after:function(e){var n=document.createDocumentFragment();y=[],function(e,t,n){var r=arguments.callee;i.forEach(t,function(t,i){for(var a=e[i]||{children:[]},c=a.node,l=n;!s.isValidParent(t.type,l.nodeName);)l=l.parentNode;c||(c=s.abstractNodeToElement(t,l)),"comment"!=t.type&&"text"!=t.type||"SCRIPT"!=l.nodeName&&"STYLE"!=l.nodeName||8!==o.internetExplorer?t.node=l.appendChild(c):(t.node=c,l.text=c.nodeValue),t.children&&r(a.children,t.children,c),("script"==t.type.toLowerCase()||"tag"==t.type.toLowerCase()&&"script"==t.name.toLowerCase())&&y.push(f(c))})}(C,e,n),C=e,t.parentNode.insertBefore(n,t.nextSibling)},finishExecuting:function(){return _.promise},resolveText:function(){return x},toString:function(){return b.isExternal()?'"'+p+'"':"inline script beginning with: "+(t.text||t.textContent||"").substring(0,50).replace(/\s+/g," ")}},x=function(){var r=e.defer();if(n.log("Resolving text content for "+(""+b)),b.isExternal())r.resolve(h(p)).then(function(){n.log("Text content resolved for "+(""+b))});else{var o="";0!==t.childNodes.length?i.forEach(t.childNodes,function(e){o+=e.nodeValue},o):o=t.text||t.textContent||"",r.resolve(o)}return r.promise}();if(o.setData(t,"rocketoptimized","true"),8===o.internetExplorer){var M=t.getAttribute,T=t.hasAttribute;t.getAttribute=function(e){return"src"===e?p:M.call(t,e)},t.hasAttribute=function(e){return"src"===e?p:T.call(t,e)},a.defineProperty(t,"src",{set:function(e){p=e,o.setData(t,"rocketsrc",e)},get:function(){return p}})}return b},m=function(e){var t=e,r=o.safari?l.proxy(e):e,s=c(r),d="loading",p="",h="",u=function(t){if(p!==t){n.log("Appending script-inserted script to execution queue."),o.setData(e,"rocketsrc",t);var r=f(e);v.pushScript(r),r.finishExecuting().then(function(){s.load()})}p=t};return i.extend(s,{load:function(){var e=s.createEvent(9>o.internetExplorer?"readystatechange":"load");d="complete",a.defineProperty(e,"readyState",function(){return d}),s.fireEvent(e.type,e)},fail:function(){s.fireEvent("error")}}),s.deferEvent("load"),s.deferEvent("readystatechange"),s.deferEvent("error"),s.wrapNativeProperty("readyState",function(){return d},function(){}),s.wrapNativeMethod("getAttribute",function(e){return"src"==e?p:s.getNativeMethod("getAttribute").apply(t,arguments)}),s.wrapNativeMethod("setAttribute",function(e,n){return"src"==e?u(n):s.getNativeMethod("setAttribute").apply(t,arguments)}),s.wrapNativeProperty("attributes.src",function(){return p},function(e){u(e)}),s.wrapNativeProperty("src",function(){return p},function(e){u(e)}),s.wrapNativeProperty("text",function(){return h},function(e){if(h=e,!p)try{a.globalEval(h)}catch(t){n.error(t.message)}return h}),s};n.log("Capturing the window and document, and gathering scripts.");var y=p(),v=u(),w=d(),C=!1,_=[],E=e.defer();return o.onLoad.then(function(){return n.log("Launching scripts."),C=!0,v.execute().then(function(){return n.log("Firing deferred ready event."),w.ready(),v.execute().then(function(){return n.log("Firing deferred load event."),y.load(),v.execute().then(function(){n.log("Fin."),E.resolve()})})})}),{push:function(e){"function"==typeof e&&_.push(e)},loads:E.promise}});